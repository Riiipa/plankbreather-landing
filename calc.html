<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор Інвестора (LMNP)</title>
    
    <!-- Підключення Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Підключення React та ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel для обробки JSX прямо в браузері -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { background-color: #f3f4f6; padding: 20px; font-family: sans-serif; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ТЕКСТИ ПЕРЕКЛАДУ (СЛОВНИК) ---
        const TRANSLATIONS = {
            ua: {
                title: "Калькулятор Інвестора (LMNP)",
                subtitle: "Симуляція: Нерухомість vs Акції vs Власне житло",
                projectCost: "Вартість Проекту",
                priceLabel: "Ціна квартири (€)",
                worksLabel: "Ремонт/Меблі (€)",
                notaryLabel: "Нотаріус (8%)",
                totalCostLabel: "Повна вартість:",
                financing: "Фінансування",
                contributionLabel: "Ваш внесок (Apport) (€)",
                rateLabel: "Ставка %",
                yearsLabel: "Років",
                insuranceLabel: "Страховка %",
                monthlyPaymentLabel: "Кредитний платіж:",
                operations: "Операційна діяльність",
                rentLabel: "Оренда (ринкова) (€/міс)",
                rentIndexLabel: "Індексація оренди (%/рік)",
                chargesLabel: "Комунальні (Charges)",
                taxLabel: "Taxe Foncière (рік)",
                otherLabel: "Інше (PNO/Бух) рік",
                monthlyCashFlow: "Щомісячний Cash Flow",
                month: "міс",
                negativeFlowMsg: "Це ваша доплата в перший рік (далі менше).",
                positiveFlowMsg: "Вітаємо! Квартира окупає себе сама.",
                whereMoneyGoes: "Куди йдуть гроші (1-й рік)",
                incomeRent: "Оренда (Дохід)",
                expenseLoan: "Кредит + Страховка",
                expenseTax: "Комунальні + Податки",
                expenseReserve: "Резерв (Простій + Ремонт)",
                expenseOther: "Інше (PNO, Бухгалтер)",
                totalExpenses: "Всього витрат",
                grossYield: "Брутто прибутковість",
                leverage: "Кредитне плече",
                summaryTitle: "Підсумок за",
                years: "років",
                tenant: "Орендар",
                you: "Ви",
                paidByTenant: "Оплачено Орендарем",
                paidByTenantDesc: "З урахуванням щорічної індексації.",
                paidByYou: "Оплачено Вами",
                paidByYouDesc: "Ваш внесок + всі щомісячні доплати.",
                bankInterest: "Переплата банку",
                bankInterestDesc: "відсотків за весь строк.",
                youWillPay: "ви заплатите",
                battleTitle: "Битва Стратегій: Через",
                battleSubtitle: "Альтернатива:",
                investInStocks: "в акції",
                totalInvested: "Всього вкладено:", 
                realEstate: "Інвест. Квартира",
                stocks: "Акції (S&P/Tech)",
                rpStrategy: "Для Себе (RP)",
                rpDescription: "Квартира + Акції (з економії)",
                currentRentLabel: "Ваша поточна оренда (€)",
                assetValue: "Вартість активу",
                atRate: "При",
                annual: "% річних",
                conservative: "(консервативно)",
                // RP Details
                rpDetailsTitle: "Деталізація: Стратегія 'Для Себе' (RP)",
                rpPropertyComponent: "Вартість Квартири (Актив)",
                rpStockComponent: "Накопичено в Акціях",
                rpTotal: "Разом Капітал",
                rpInvestedCash: "Живих грошей вкладено в акції:",
                rpExplanation: "Ви живете у власній квартирі, а різницю між кредитом і колишньою орендою інвестуєте."
            },
            ru: {
                title: "Калькулятор Инвестора (LMNP)",
                subtitle: "Симуляция: Недвижимость vs Акции vs Жилье для себя",
                projectCost: "Стоимость Проекта",
                priceLabel: "Цена квартиры (€)",
                worksLabel: "Ремонт/Мебель (€)",
                notaryLabel: "Нотариус (8%)",
                totalCostLabel: "Полная стоимость:",
                financing: "Финансирование",
                contributionLabel: "Ваш взнос (Apport) (€)",
                rateLabel: "Ставка %",
                yearsLabel: "Лет",
                insuranceLabel: "Страховка %",
                monthlyPaymentLabel: "Кредитный платеж:",
                operations: "Операционная деятельность",
                rentLabel: "Аренда (рыночная) (€/мес)",
                rentIndexLabel: "Индексация аренды (%/год)",
                chargesLabel: "Коммунальные (Charges)",
                taxLabel: "Taxe Foncière (год)",
                otherLabel: "Другое (PNO/Бух) год",
                monthlyCashFlow: "Ежемесячный Cash Flow",
                month: "мес",
                negativeFlowMsg: "Это ваша доплата в первый год (далее меньше).",
                positiveFlowMsg: "Поздравляем! Квартира окупает себя сама.",
                whereMoneyGoes: "Куда уходят деньги (1-й год)",
                incomeRent: "Аренда (Доход)",
                expenseLoan: "Кредит + Страховка",
                expenseTax: "Коммунальные + Налоги",
                expenseReserve: "Резерв (Простой + Ремонт)",
                expenseOther: "Другое (PNO, Бухгалтер)",
                totalExpenses: "Всего расходов",
                grossYield: "Брутто доходность",
                leverage: "Кредитное плечо",
                summaryTitle: "Итог за",
                years: "лет",
                tenant: "Арендатор",
                you: "Вы",
                paidByTenant: "Оплачено Арендатором",
                paidByTenantDesc: "С учетом ежегодной индексации.",
                paidByYou: "Оплачено Вами",
                paidByYouDesc: "Ваш взнос + все ежемесячные доплаты.",
                bankInterest: "Переплата банку",
                bankInterestDesc: "процентов за весь срок.",
                youWillPay: "вы заплатите",
                battleTitle: "Битва Стратегий: Через",
                battleSubtitle: "Альтернатива:",
                investInStocks: "в акции",
                totalInvested: "Всего вложено:", 
                realEstate: "Инвест. Квартира",
                stocks: "Акции (S&P/Tech)",
                rpStrategy: "Для Себя (RP)",
                rpDescription: "Квартира + Акции (из экономии)",
                currentRentLabel: "Ваша текущая аренда (€)",
                assetValue: "Стоимость актива",
                atRate: "При",
                annual: "% годовых",
                conservative: "(консервативно)",
                // RP Details
                rpDetailsTitle: "Детализация: Стратегия 'Для Себя' (RP)",
                rpPropertyComponent: "Стоимость Квартиры (Актив)",
                rpStockComponent: "Накоплено в Акциях",
                rpTotal: "Итого Капитал",
                rpInvestedCash: "Живых денег вложено в акции:",
                rpExplanation: "Вы живете в собственной квартире, а разницу между кредитом и бывшей арендой инвестируете."
            }
        };

        // --- ІКОНКИ ---
        const IconWrapper = ({ children, color = "currentColor", size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );
        const Home = (props) => <IconWrapper {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></IconWrapper>;
        const Calculator = (props) => <IconWrapper {...props}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></IconWrapper>;
        const Euro = (props) => <IconWrapper {...props}><path d="M4 10h12"/><path d="M4 14h9"/><path d="M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2"/></IconWrapper>;
        const TrendingUp = (props) => <IconWrapper {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></IconWrapper>;
        const Info = (props) => <IconWrapper {...props}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></IconWrapper>;
        const Users = (props) => <IconWrapper {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconWrapper>;
        const Wallet = (props) => <IconWrapper {...props}><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></IconWrapper>;
        const PieChart = (props) => <IconWrapper {...props}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10Z"/></IconWrapper>;
        const Banknote = (props) => <IconWrapper {...props}><rect width="20" height="12" x="2" y="6" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></IconWrapper>;
        const LineChart = (props) => <IconWrapper {...props}><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></IconWrapper>;


        // --- ГОЛОВНИЙ КОМПОНЕНТ ---
        const RealEstateCalculator = () => {
            const [lang, setLang] = useState('ua'); 
            const t = TRANSLATIONS[lang];

            // --- STATE: Вхідні дані ---
            const [price, setPrice] = useState(150000);
            const [area, setArea] = useState(19);
            const [works, setWorks] = useState(10000); 
            
            const [contribution, setContribution] = useState(25000); 
            const [rate, setRate] = useState(3.7); 
            const [duration, setDuration] = useState(20); 
            const [insuranceRate, setInsuranceRate] = useState(0.35); 

            const [rent, setRent] = useState(750); 
            const [rentIndexation, setRentIndexation] = useState(2.0);
            const [chargesCopro, setChargesCopro] = useState(70); 
            const [taxeFonciere, setTaxeFonciere] = useState(600); 
            const [otherExpenses, setOtherExpenses] = useState(400); 
            const [vacancyRate, setVacancyRate] = useState(5); 

            // NEW: Поточна оренда для порівняння RP
            const [currentRent, setCurrentRent] = useState(1250);

            const [sp500Rate, setSp500Rate] = useState(8); 
            const [techRate, setTechRate] = useState(12); 

            // --- БАЗОВІ РОЗРАХУНКИ ---
            const notaryFees = price * 0.08; 
            const totalProjectCost = price + works + notaryFees;
            const loanAmount = totalProjectCost - contribution;

            // Кредит
            const monthlyRate = rate / 100 / 12;
            const numberOfPayments = duration * 12;
            const monthlyMortgage = loanAmount > 0 
                ? (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1) 
                : 0;
            const monthlyInsurance = (loanAmount * (insuranceRate / 100)) / 12;
            const totalMonthlyLoan = monthlyMortgage + monthlyInsurance;

            // Витрати щомісячні
            const monthlyTaxeFonciere = taxeFonciere / 12;
            const monthlyOtherExpenses = otherExpenses / 12;
            const monthlyVacancy = rent * (vacancyRate / 100);
            const managementFee = 0; 
            const totalMonthlyExpenses = chargesCopro + monthlyTaxeFonciere + monthlyOtherExpenses + managementFee + monthlyVacancy;
            const totalOutflow = totalMonthlyLoan + totalMonthlyExpenses;
            const initialCashFlow = rent - totalOutflow;
            const grossYield = (rent * 12 / totalProjectCost) * 100;

            // --- SIMULATION ---
            const simulation = useMemo(() => {
                let totalTenantPaid = 0;
                let totalInvestorPaid = 0; 
                let totalRealEstateSurplus = 0; 
                
                let sp500Balance = contribution;
                let techBalance = contribution;
                let rpStockBalance = contribution; // Портфель для стратегії RP
                let rpCashInvested = 0; // Чисті вкладені гроші в акції для RP

                let totalInvestedPrincipal = contribution;

                const monthlyExpFixed = chargesCopro + monthlyTaxeFonciere + monthlyOtherExpenses + managementFee;
                
                for (let year = 0; year < duration; year++) {
                    const currentMonthlyRent = rent * Math.pow(1 + rentIndexation/100, year);
                    const currentMonthlyVacancy = currentMonthlyRent * (vacancyRate / 100);
                    const netMonthlyRent = currentMonthlyRent - currentMonthlyVacancy;
                    
                    // 1. INVESTMENT FLAT LOGIC
                    const monthlyCF = netMonthlyRent - monthlyExpFixed - totalMonthlyLoan;
                    totalTenantPaid += netMonthlyRent * 12;
                    
                    if (monthlyCF < 0) {
                        totalInvestorPaid += Math.abs(monthlyCF) * 12;
                        totalInvestedPrincipal += Math.abs(monthlyCF) * 12;
                        
                        const monthlyInvestment = Math.abs(monthlyCF);
                        sp500Balance = sp500Balance * (1 + sp500Rate/100) + (monthlyInvestment * 12);
                        techBalance = techBalance * (1 + techRate/100) + (monthlyInvestment * 12);
                    } else {
                        totalRealEstateSurplus += monthlyCF * 12;
                        sp500Balance = sp500Balance * (1 + sp500Rate/100);
                        techBalance = techBalance * (1 + techRate/100);
                    }

                    // 2. RP (RESIDENCE PRINCIPALE) LOGIC
                    const currentTotalOutflow = totalMonthlyLoan + monthlyExpFixed + currentMonthlyVacancy;
                    const monthlyInvestRP = currentRent - currentTotalOutflow + currentMonthlyRent;
                    
                    if (monthlyInvestRP > 0) {
                        rpStockBalance = rpStockBalance * (1 + techRate/100) + (monthlyInvestRP * 12);
                        rpCashInvested += monthlyInvestRP * 12;
                    } else {
                        rpStockBalance = rpStockBalance * (1 + techRate/100); 
                    }
                }

                const totalInvestorCost = contribution + totalInvestorPaid;
                const finalPropertyPrice = price * Math.pow(1.02, duration);
                const finalRealEstateValue = finalPropertyPrice + totalRealEstateSurplus;
                const finalRPValue = finalPropertyPrice + rpStockBalance; 

                return {
                    totalTenantPaid,
                    totalInvestorPaid: totalInvestorCost,
                    totalInvestedPrincipal,
                    finalRealEstateValue,
                    finalSP500Value: sp500Balance,
                    finalTechValue: techBalance,
                    finalRPValue,
                    rpStockBalance,
                    rpCashInvested,
                    finalPropertyPrice
                };

            }, [price, rent, rentIndexation, duration, contribution, totalMonthlyLoan, chargesCopro, monthlyTaxeFonciere, monthlyOtherExpenses, vacancyRate, sp500Rate, techRate, currentRent]);

            const percentTenant = Math.min(100, Math.max(0, (simulation.totalTenantPaid / (simulation.totalTenantPaid + simulation.totalInvestorPaid)) * 100));
            const percentInvestor = 100 - percentTenant;

            const totalLoanRepayment = totalMonthlyLoan * duration * 12;
            const costOfCredit = totalLoanRepayment - loanAmount;

            const maxValue = Math.max(simulation.finalRealEstateValue, simulation.finalSP500Value, simulation.finalTechValue, simulation.finalRPValue);

            return (
                <div className="max-w-4xl mx-auto p-4 bg-gray-50 rounded-xl font-sans text-gray-800 shadow-xl">
                    <div className="flex items-center justify-between mb-6 border-b pb-4 border-gray-200">
                        <div className="flex items-center gap-2">
                            <Home className="text-blue-600 w-8 h-8" />
                            <div>
                                <h1 className="text-2xl font-bold text-gray-900">{t.title}</h1>
                                <p className="text-sm text-gray-500">{t.subtitle}</p>
                            </div>
                        </div>
                        <div className="flex bg-gray-200 rounded-lg p-1">
                            <button onClick={() => setLang('ua')} className={`px-3 py-1 rounded-md text-sm font-semibold transition-colors ${lang === 'ua' ? 'bg-white text-blue-800 shadow-sm' : 'text-gray-600 hover:text-gray-900'}`}>UA</button>
                            <button onClick={() => setLang('ru')} className={`px-3 py-1 rounded-md text-sm font-semibold transition-colors ${lang === 'ru' ? 'bg-white text-blue-800 shadow-sm' : 'text-gray-600 hover:text-gray-900'}`}>RU</button>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        {/* ЛІВА КОЛОНКА */}
                        <div className="space-y-6">
                            <div className="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                                <h3 className="text-md font-semibold text-blue-800 mb-4 flex items-center gap-2"><Calculator size={18}/> {t.projectCost}</h3>
                                <div className="space-y-3">
                                    <div><label className="text-xs font-medium text-gray-500 uppercase">{t.priceLabel}</label><input type="number" value={price} onChange={(e) => setPrice(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md focus:ring-2 focus:ring-blue-500 outline-none transition"/></div>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div><label className="text-xs font-medium text-gray-500 uppercase">{t.worksLabel}</label><input type="number" value={works} onChange={(e) => setWorks(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                        <div><label className="text-xs font-medium text-gray-500 uppercase">{t.notaryLabel}</label><div className="w-full mt-1 p-2 bg-gray-100 rounded-md text-gray-600">{notaryFees.toLocaleString()} €</div></div>
                                    </div>
                                    <div className="pt-2 border-t flex justify-between items-center"><span className="font-semibold text-sm">{t.totalCostLabel}</span><span className="font-bold text-lg text-blue-900">{totalProjectCost.toLocaleString()} €</span></div>
                                </div>
                            </div>

                            <div className="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                                <h3 className="text-md font-semibold text-blue-800 mb-4 flex items-center gap-2"><Euro size={18}/> {t.financing}</h3>
                                <div className="space-y-3">
                                    <div><label className="text-xs font-medium text-gray-500 uppercase">{t.contributionLabel}</label><input type="number" value={contribution} onChange={(e) => setContribution(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md focus:ring-2 focus:ring-blue-500 outline-none"/></div>
                                    <div className="grid grid-cols-3 gap-3">
                                        <div className="col-span-1"><label className="text-xs font-medium text-gray-500 uppercase">{t.rateLabel}</label><input type="number" step="0.01" value={rate} onChange={(e) => setRate(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                        <div className="col-span-1"><label className="text-xs font-medium text-gray-500 uppercase">{t.yearsLabel}</label><input type="number" value={duration} onChange={(e) => setDuration(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                        <div className="col-span-1"><label className="text-xs font-medium text-gray-500 uppercase">{t.insuranceLabel}</label><input type="number" step="0.01" value={insuranceRate} onChange={(e) => setInsuranceRate(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                    </div>
                                    <div className="p-3 bg-blue-50 rounded-md flex justify-between items-center border border-blue-100"><span className="text-sm text-blue-800 font-medium">{t.monthlyPaymentLabel}</span><span className="font-bold text-blue-900">{totalMonthlyLoan.toFixed(0)} €/{t.month}</span></div>
                                </div>
                            </div>

                            <div className="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                                <h3 className="text-md font-semibold text-blue-800 mb-4 flex items-center gap-2"><TrendingUp size={18}/> {t.operations}</h3>
                                <div className="grid grid-cols-2 gap-4">
                                    <div><label className="text-xs font-medium text-green-600 uppercase">{t.rentLabel}</label><input type="number" value={rent} onChange={(e) => setRent(Number(e.target.value))} className="w-full mt-1 p-2 border border-green-200 bg-green-50 rounded-md font-semibold text-green-800"/></div>
                                    <div><label className="text-xs font-medium text-green-600 uppercase">{t.rentIndexLabel}</label><input type="number" step="0.1" value={rentIndexation} onChange={(e) => setRentIndexation(Number(e.target.value))} className="w-full mt-1 p-2 border border-green-200 rounded-md text-green-800"/></div>
                                    <div><label className="text-xs font-medium text-red-500 uppercase">{t.chargesLabel}</label><input type="number" value={chargesCopro} onChange={(e) => setChargesCopro(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                    <div><label className="text-xs font-medium text-red-500 uppercase">{t.taxLabel}</label><input type="number" value={taxeFonciere} onChange={(e) => setTaxeFonciere(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                    <div><label className="text-xs font-medium text-red-500 uppercase">{t.otherLabel}</label><input type="number" value={otherExpenses} onChange={(e) => setOtherExpenses(Number(e.target.value))} className="w-full mt-1 p-2 border rounded-md"/></div>
                                </div>
                            </div>
                        </div>

                        {/* ПРАВА КОЛОНКА */}
                        <div className="space-y-6">
                            <div className={`p-6 rounded-xl shadow-md text-white ${initialCashFlow >= 0 ? 'bg-green-600' : 'bg-slate-800'}`}>
                                <h2 className="text-sm font-medium opacity-80 uppercase tracking-wider mb-1">{t.monthlyCashFlow}</h2>
                                <div className="flex items-baseline gap-2">
                                    <span className="text-5xl font-bold">{initialCashFlow > 0 ? '+' : ''}{initialCashFlow.toFixed(0)} €</span>
                                    <span className="text-lg opacity-80">/ {t.month}</span>
                                </div>
                                <p className="mt-4 text-sm opacity-90 flex items-start gap-2"><Info size={16} className="mt-1 flex-shrink-0" />{initialCashFlow < 0 ? t.negativeFlowMsg : t.positiveFlowMsg}</p>
                            </div>

                            <div className="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                                <h3 className="text-lg font-bold text-gray-800 mb-4">{t.whereMoneyGoes}</h3>
                                <div className="space-y-3">
                                    <div className="flex justify-between items-center pb-2 border-b border-gray-100"><span className="text-green-700 font-semibold">{t.incomeRent}</span><span className="text-green-700 font-bold">+ {rent} €</span></div>
                                    <div className="flex justify-between items-center text-sm"><span className="text-gray-600 pl-2 border-l-2 border-blue-500">{t.expenseLoan}</span><span className="text-red-500 font-medium">- {totalMonthlyLoan.toFixed(0)} €</span></div>
                                    <div className="flex justify-between items-center text-sm"><span className="text-gray-600 pl-2 border-l-2 border-orange-400">{t.expenseTax}</span><span className="text-red-500 font-medium">- {(chargesCopro + monthlyTaxeFonciere).toFixed(0)} €</span></div>
                                    <div className="flex justify-between items-center text-sm"><span className="text-gray-600 pl-2 border-l-2 border-purple-400">{t.expenseOther}</span><span className="text-red-500 font-medium">- {monthlyOtherExpenses.toFixed(0)} €</span></div>
                                    <div className="flex justify-between items-center text-sm"><span className="text-gray-600 pl-2 border-l-2 border-yellow-400">{t.expenseReserve}</span><span className="text-red-500 font-medium">- {(monthlyVacancy + rent*0.05).toFixed(0)} €</span></div>
                                    <div className="pt-3 mt-2 border-t flex justify-between items-center font-bold"><span className="text-gray-800">{t.totalExpenses}</span><span className="text-red-600">- {totalOutflow.toFixed(0)} €</span></div>
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <div className="bg-blue-50 p-4 rounded-lg text-center"><div className="text-xs text-blue-600 uppercase font-semibold mb-1">{t.grossYield}</div><div className="text-2xl font-bold text-blue-900">{grossYield.toFixed(2)}%</div></div>
                                <div className="bg-purple-50 p-4 rounded-lg text-center"><div className="text-xs text-purple-600 uppercase font-semibold mb-1">{t.leverage}</div><div className="text-2xl font-bold text-purple-900">{((loanAmount/totalProjectCost)*100).toFixed(0)}%</div></div>
                            </div>
                        </div>
                    </div>

                    {/* ПІДСУМОК ЗА ВЕСЬ ЧАС */}
                    <div className="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mb-8">
                        <div className="bg-gray-900 p-4 flex items-center gap-3"><PieChart className="text-green-400" /><h2 className="text-white text-lg font-bold">{t.summaryTitle} {duration} {t.years}</h2></div>
                        <div className="p-6 grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                            <div className="md:col-span-1 flex flex-col items-center justify-center">
                                <div className="w-full h-8 bg-blue-900 rounded-full overflow-hidden flex relative shadow-inner">
                                    <div className="h-full bg-green-500 flex items-center justify-center text-xs font-bold text-white transition-all duration-1000" style={{ width: `${percentTenant}%` }}>{percentTenant.toFixed(0)}%</div>
                                    <div className="h-full flex items-center justify-center text-xs font-bold text-white flex-1">{percentInvestor.toFixed(0)}%</div>
                                </div>
                                <div className="flex justify-between w-full mt-2 text-sm font-semibold"><span className="text-green-600">{t.tenant}</span><span className="text-blue-900">{t.you}</span></div>
                            </div>
                            <div className="md:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div className="p-4 bg-green-50 rounded-lg border border-green-100 relative"><div className="absolute top-4 right-4 text-green-200"><Users size={24} /></div><p className="text-xs text-green-600 uppercase font-bold">{t.paidByTenant}</p><p className="text-2xl font-bold text-green-800 mt-1">{simulation.totalTenantPaid.toLocaleString(undefined, {maximumFractionDigits: 0})} €</p><p className="text-xs text-green-600 mt-2">{t.paidByTenantDesc}</p></div>
                                <div className="p-4 bg-blue-50 rounded-lg border border-blue-100 relative"><div className="absolute top-4 right-4 text-blue-200"><Wallet size={24} /></div><p className="text-xs text-blue-600 uppercase font-bold">{t.paidByYou}</p><p className="text-2xl font-bold text-blue-900 mt-1">{simulation.totalInvestorPaid.toLocaleString(undefined, {maximumFractionDigits: 0})} €</p><p className="text-xs text-blue-500 mt-2">{t.paidByYouDesc}</p></div>
                                <div className="col-span-1 sm:col-span-2 mt-2 p-4 bg-red-50 rounded-lg border border-red-100 relative"><div className="flex gap-4 items-center"><div className="p-2 bg-red-100 rounded-full text-red-600 hidden sm:block"><Banknote size={24} /></div><div><p className="text-sm font-semibold text-red-800 mb-1">{t.bankInterest}</p><p className="text-xs text-gray-600 mb-2">{t.summaryTitle} {duration} {t.years} {t.youWillPay} <span className="font-bold text-red-700">{costOfCredit.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span> {t.bankInterestDesc}</p></div></div></div>
                            </div>
                        </div>
                    </div>

                    {/* БИТВА СТРАТЕГІЙ */}
                    <div className="bg-gradient-to-br from-indigo-900 to-slate-900 rounded-xl shadow-lg border border-indigo-800 overflow-hidden mb-8">
                        <div className="p-6 border-b border-indigo-800 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                            <div>
                                <h2 className="text-white text-xl font-bold flex items-center gap-2"><LineChart className="text-yellow-400" />{t.battleTitle} {duration} {t.years}</h2>
                                <p className="text-indigo-200 text-sm mt-1">
                                    {t.battleSubtitle} {t.totalInvested} 
                                    <span className="ml-2 text-indigo-100 font-semibold bg-indigo-800 px-2 py-0.5 rounded text-xs">
                                         {simulation.totalInvestedPrincipal.toLocaleString(undefined, {maximumFractionDigits: 0})} €
                                    </span>
                                </p>
                            </div>
                            <div className="flex gap-4 items-end text-xs">
                                <div><label className="text-indigo-300 block mb-1">S&P500 %</label><input type="number" value={sp500Rate} onChange={e => setSp500Rate(Number(e.target.value))} className="bg-indigo-950 text-white border border-indigo-700 rounded p-1 w-20 text-center"/></div>
                                <div><label className="text-indigo-300 block mb-1">Tech %</label><input type="number" value={techRate} onChange={e => setTechRate(Number(e.target.value))} className="bg-indigo-950 text-white border border-indigo-700 rounded p-1 w-20 text-center"/></div>
                                <div><label className="text-indigo-300 block mb-1">{t.currentRentLabel}</label><input type="number" value={currentRent} onChange={e => setCurrentRent(Number(e.target.value))} className="bg-indigo-950 text-white border border-indigo-700 rounded p-1 w-24 text-center"/></div>
                            </div>
                        </div>
                        
                        <div className="p-8">
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4 items-end h-72">
                                {/* НЕРУХОМІСТЬ */}
                                <div className="flex flex-col justify-end h-full group">
                                    <div className="text-center mb-2 flex-grow flex flex-col justify-end">
                                        <span className="text-indigo-200 text-xs font-semibold uppercase tracking-wider block mb-1">{t.realEstate}</span>
                                        <span className="text-white text-lg font-bold">{simulation.finalRealEstateValue.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                    </div>
                                    <div className="h-48 w-full flex items-end">
                                        <div className="w-full bg-blue-600 rounded-t-lg relative transition-all duration-500 hover:bg-blue-500" 
                                             style={{height: `${(simulation.finalRealEstateValue / maxValue) * 100}%`}}>
                                        </div>
                                    </div>
                                </div>

                                {/* S&P 500 */}
                                <div className="flex flex-col justify-end h-full group">
                                    <div className="text-center mb-2 flex-grow flex flex-col justify-end">
                                        <span className="text-indigo-200 text-xs font-semibold uppercase tracking-wider block mb-1">S&P 500</span>
                                        <span className="text-white text-lg font-bold">{simulation.finalSP500Value.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                    </div>
                                    <div className="h-48 w-full flex items-end">
                                        <div className="w-full bg-yellow-500 rounded-t-lg relative transition-all duration-500 hover:bg-yellow-400" 
                                             style={{height: `${(simulation.finalSP500Value / maxValue) * 100}%`}}>
                                        </div>
                                    </div>
                                </div>

                                {/* TECH */}
                                <div className="flex flex-col justify-end h-full group">
                                    <div className="text-center mb-2 flex-grow flex flex-col justify-end">
                                        <span className="text-indigo-200 text-xs font-semibold uppercase tracking-wider block mb-1">{t.stocks}</span>
                                        <span className="text-white text-lg font-bold">{simulation.finalTechValue.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                    </div>
                                    <div className="h-48 w-full flex items-end">
                                        <div className="w-full bg-purple-600 rounded-t-lg relative transition-all duration-500 hover:bg-purple-500" 
                                             style={{height: `${(simulation.finalTechValue / maxValue) * 100}%`}}>
                                        </div>
                                    </div>
                                </div>

                                {/* RP (FOR SELF) */}
                                <div className="flex flex-col justify-end h-full group">
                                    <div className="text-center mb-2 flex-grow flex flex-col justify-end">
                                        <span className="text-indigo-200 text-xs font-semibold uppercase tracking-wider block mb-1">{t.rpStrategy}</span>
                                        <span className="text-white text-lg font-bold">{simulation.finalRPValue.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                        <span className="text-xs text-indigo-400 block mt-1 leading-tight">{t.rpDescription}</span>
                                    </div>
                                    <div className="h-48 w-full flex items-end">
                                        <div className="w-full bg-green-500 rounded-t-lg relative transition-all duration-500 hover:bg-green-400" 
                                             style={{height: `${(simulation.finalRPValue / maxValue) * 100}%`}}>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* NEW: RP BREAKDOWN BLOCK */}
                    <div className="bg-white p-6 rounded-xl shadow-md border border-gray-200">
                         <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                             <span className="p-1 bg-green-100 text-green-600 rounded"><Home size={20}/></span>
                             {t.rpDetailsTitle}
                         </h3>
                         <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            
                            <div className="p-4 bg-gray-50 rounded-lg border border-gray-100">
                                <span className="text-xs text-gray-500 uppercase font-bold block mb-1">{t.rpPropertyComponent}</span>
                                <span className="text-2xl font-bold text-blue-900">{simulation.finalPropertyPrice.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                <span className="text-xs text-blue-400 block mt-1">Ціна активу через {duration} років</span>
                            </div>

                            <div className="p-4 bg-gray-50 rounded-lg border border-gray-100">
                                <span className="text-xs text-gray-500 uppercase font-bold block mb-1">{t.rpStockComponent}</span>
                                <span className="text-2xl font-bold text-purple-900">{simulation.rpStockBalance.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                <div className="text-xs text-gray-500 mt-2">
                                    <div>{t.rpInvestedCash} <span className="font-semibold">{simulation.rpCashInvested.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span></div>
                                    <div className="text-purple-500">+ {(simulation.rpStockBalance - simulation.rpCashInvested).toLocaleString(undefined, {maximumFractionDigits: 0})} € (Прибуток %)</div>
                                </div>
                            </div>

                            <div className="p-4 bg-green-50 rounded-lg border border-green-200 flex flex-col justify-center">
                                <span className="text-xs text-green-700 uppercase font-bold block mb-1">{t.rpTotal}</span>
                                <span className="text-3xl font-bold text-green-900">{simulation.finalRPValue.toLocaleString(undefined, {maximumFractionDigits: 0})} €</span>
                                <span className="text-xs text-green-600 mt-1 leading-tight opacity-80">{t.rpExplanation}</span>
                            </div>

                         </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RealEstateCalculator />);
    </script>
</body>
</html>
